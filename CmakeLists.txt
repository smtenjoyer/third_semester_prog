cmake_minimum_required(VERSION 3.6.0)

# Определяем номер версии проекта с помощью CMAKE_VERSION
set(PROJECT_VERSION 0.0.1 CACHE INTERNAL "Project version")

project(ip_check VERSION ${PROJECT_VERSION})

# Копирование ip_filter.tsv в папку сборки
add_custom_command(
    OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/ip_filter.tsv
    COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_CURRENT_SOURCE_DIR}/ip_filter.tsv ${CMAKE_CURRENT_BINARY_DIR}/
    DEPENDS ${CMAKE_CURRENT_SOURCE_DIR}/ip_filter.tsv
)

set(CMAKE_CXX_STANDARD 17)
set(CXX_STANDARD_REQUIRED ON)
set(CPACK_GENERATOR ZIP)

# Используем CMAKE_VERSION для определения версии пакета
set(CPACK_PACKAGE_VERSION ${CMAKE_VERSION})
include(CPack)
enable_testing()
add_subdirectory(gtests)

set(CPACK_PROJECT_NAME ${PROJECT_NAME})
set(CPACK_PROJECT_VERSION ${PROJECT_VERSION})